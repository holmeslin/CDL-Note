## 2.2 Google Cloud Data Management Solutions

### 2.2.1 Unstructured data storage

**非結構化數據存儲**：

-   **需求**：不同應用程序和工作負載需要不同的存儲解決方案，如流媒體媒體或設備傳感器數據。

**Google Cloud 核心存儲產品**：

-   **主要產品**：Cloud Storage、Cloud SQL、Spanner、BigQuery、Firestore 和 Bigtable。
-   **使用情況**：根據具體需求，可以選擇一種或多種服務。

**Cloud Storage**：

-   **概述**：為開發人員和 IT 組織提供持久且高度可用的對象存儲服務。
-   **對象存儲**：管理數據為“對象”，包含二進制形式的實際數據和相關元數據，如創建日期、作者、資源類型和許可權。
-   **常見數據**：視頻、圖片和音頻記錄，通常為非結構化數據。

**Cloud Storage 的主要存儲類別**：

1. **標準存儲 (Standard Storage)**：適合頻繁訪問的“熱”數據，也適合短期存儲的數據。
2. **近線存儲 (Nearline Storage)**：適合不頻繁訪問的數據，如每月或更少次的讀取或修改，適用於數據備份、長尾多媒體內容或數據歸檔。
3. **冷線存儲 (Coldline Storage)**：低成本選擇，適合每 90 天最多讀取或修改一次的數據。
4. **歸檔存儲 (Archive Storage)**：成本最低，適合每年訪問不到一次的數據，適用於數據歸檔、在線備份和災難恢復。

**共同特徵**：

-   無限制存儲，無最小對象大小要求。
-   全球可訪問性和多位置存儲。
-   低延遲和高耐久性。
-   統一的安全性、工具和 API 體驗。
-   多區域或雙區域存儲具有地理冗餘性，保護數據免受災難事件影響，並進行流量負載均衡以優化性能。

**Autoclass 功能**：

-   **自動分類**：根據對象的訪問模式自動轉換存儲類別。
-   **優化成本**：未訪問數據移至較冷存儲類別以降低成本，訪問數據移至標準存儲以優化未來訪問。
-   **簡化自動化**：自動化和簡化 Cloud Storage 數據的成本節省。

### 2.2.2 Structured data storage

**結構化數據存儲**：

-   **概述**：

    -   結構化數據由數字和數值組成，按預定義格式組織，易於在關係數據庫中搜索。
    -   Google Cloud 提供多種數據存儲產品，用於存儲結構化數據。

-   **主要產品**：

    1. **Cloud SQL**：

        - **功能**：完全托管的關係數據庫服務，支持 MySQL、PostgreSQL 和 SQL Server。
        - **優點**：無需安裝或維護軟件，支持托管備份，加密客戶數據，包含網絡防火牆。
        - **適用場景**：適合不需要水平擴展或全球可用系統的業務，提供超過 99.95% 的可用性。

    2. **Spanner**：

        - **功能**：完全托管的關鍵任務關係數據庫服務，支持水平擴展，具有強一致性和高可用性。
        - **優點**：處理意外業務激增，內置高可用性和數據冗餘，提供全球一致性和高讀寫性能。
        - **適用場景**：適合需要水平擴展、全球數據、一致性和高性能的業務，提供高達 99.999% 的可用性。

    3. **BigQuery**：
        - **功能**：完全托管的數據倉庫，適合存儲和分析數 PB 的數據。
        - **優點**：支持 SQL 查詢、內置機器學習、地理空間分析和商業智能功能，數據靜態加密，與多雲環境無縫集成。
        - **適用場景**：適合需要多雲策略、數據整合和治理的業務，幫助企業消除數據孤島並進行跨雲數據分析。

-   **選擇指南**：

    -   **Cloud SQL vs. Spanner**：
        -   **Cloud SQL**：適合不需要水平擴展或全球可用系統的業務，具有成本效益，停機時間最少。
        -   **Spanner**：適合需要無限擴展性、強一致性和高可用性的業務，能處理高讀寫操作和全球數據需求。

-   **BigQuery 的特點**：
    -   **存儲和分析**：提供存儲和分析功能，支持存儲數 PB 的數據。
    -   **內置功能**：內置機器學習和地理空間分析，支持業務智能決策。
    -   **多雲環境**：支持多雲環境數據分析，幫助消除數據孤島。
    -   **數據安全**：數據靜態加密，無需用戶操作。

Google Cloud 提供多種存儲解決方案，幫助組織根據不同需求選擇最合適的存儲產品，實現數據的高效管理和分析。

### 2.2.3 Semi-structured data storage

**半結構化數據存儲**：

-   **概述**：

    -   半結構化數據包含結構化和非結構化數據的元素，具有一些組織特徵，但不如關係型數據庫那樣嚴格。
    -   這類數據通常包含標籤或元數據，使其比非結構化數據更易於組織和分析。

-   **示例**：

    -   電子郵件是一個例子，雖然其內容是非結構化的，但包含結構化數據，如發件人和收件人的姓名和電子郵件地址、發送時間等。

-   **Google Cloud 半結構化數據存儲產品**：

    1. **Firestore**：

        - **功能**：靈活、水平可擴展的 NoSQL 雲數據庫，用於實時存儲和同步數據。
        - **數據存儲形式**：以文檔形式存儲在集合中，支持多種數據類型（如嵌套對象、數字和字符串）。
        - **主要特點**：自動擴展，無論數據庫大小都能保持性能；支持離線使用，確保應用程序即使在用戶斷開互聯網連接時也能運行。

    2. **Bigtable**：
        - **功能**：Google 的 NoSQL 大數據數據庫服務，支持核心 Google 服務（如搜索、分析、地圖和 Gmail）。
        - **設計目的**：處理大工作負載，保持一致的低延遲和高吞吐量。
        - **適用場景**：適用於操作和分析應用程序（如物聯網、用戶分析和金融數據分析），特別是處理超過 1TB 的數據、快速變化的數據、NoSQL 數據、時間序列數據或大數據及機器學習算法。

-   **選擇指南**：
    -   **Firestore**：適合需要實時數據存儲和同步、需要自動擴展和離線使用支持的應用程序。
    -   **Bigtable**：適合處理大數據工作負載、需要快速高吞吐量的數據處理、處理 NoSQL 和時間序列數據的應用程序。

Google Cloud 提供的這兩種半結構化數據存儲解決方案，可以根據不同需求選擇合適的產品，實現高效的數據管理和分析。

### 2.2.4 Choosing the right storage product

**Google Cloud 存儲選項及其適用場景**

**1. 非結構化數據存儲：Cloud Storage**

-   適用於存儲非結構化數據（如媒體文件、傳感器數據等）。
-   需要選擇存儲類別：
    -   **Standard**：適合頻繁訪問的數據。
    -   **Nearline**：適合每月訪問一次或更少的數據。
    -   **Coldline**：適合每 90 天訪問一次或更少的數據。
    -   **Archive**：適合每年訪問一次或更少的數據，最適合歸檔和災難恢復。
-   **Autoclass**：根據數據訪問模式自動選擇適當的存儲類別。

**2. 結構化和半結構化數據存儲**

**A. 交易型工作負載（OLTP）**

-   用於需要快速數據插入和更新的系統，例如銷售點交易記錄。
-   **使用 SQL 訪問**
    -   **Cloud SQL**：適合本地到區域的可擴展性。
    -   **Spanner**：適合全球擴展數據庫，具有高可用性和全球一致性。
-   **不使用 SQL 訪問**
    -   **Firestore**：交易型 NoSQL，面向文檔的數據庫，支持實時數據存儲和同步，具有自動擴展和離線使用功能。

**B. 分析型工作負載（OLAP）**

-   用於需要讀取整個數據集和進行複雜查詢（例如聚合）的系統，例如分析銷售歷史。
-   **使用 SQL 命令**
    -   **BigQuery**：Google 的數據倉庫解決方案，適合分析 PB 級數據集，提供存儲和分析服務，支持機器學習和地理空間分析。
-   **不使用 SQL 命令**
    -   **Bigtable**：可擴展的 NoSQL 解決方案，適合需要毫秒級延遲的實時高吞吐量應用程序。

**3. 選擇指南**

-   **Cloud Storage**：非結構化數據（媒體、備份、歸檔）。
-   **Cloud SQL 和 Spanner**：結構化數據的交易型工作負載，使用 SQL 訪問。
-   **Firestore**：結構化數據的交易型工作負載，不使用 SQL 訪問。
-   **BigQuery**：結構化數據的分析型工作負載，使用 SQL 訪問。
-   **Bigtable**：半結構化數據的分析型工作負載，不使用 SQL 訪問。

### 2.2.5 Database migration and modernization

**現代化數據庫運行與遷移**

**1. 運行現代應用在遺留本地數據庫上的挑戰**

-   遺留本地數據庫需要克服延遲、吞吐量、可用性和擴展性等方面的昂貴且耗時的挑戰。

**2. 數據庫現代化的好處**

-   組織可以相對輕鬆地將數據從傳統數據庫遷移到完全託管或現代數據庫，享受雲提供商管理數據和基礎設施的好處。

**3. 遷移方法**

-   **提升和轉移平台遷移**：將數據庫從本地和私有雲環境遷移到公共雲提供商託管的相同類型數據庫。這種方法變動最小，但現代化較難。
-   **託管數據庫遷移**：將 SQL Server、MySQL、PostgreSQL 等數據庫遷移到完全託管的 Google Cloud 數據庫。需要仔細規劃，可能會引起輕微的變動，但能讓組織專注於更高優先級的工作。

**4. Google Cloud 的數據庫遷移服務**

-   **Database Migration Service (DMS)**：輕鬆將數據庫遷移到 Google Cloud。
-   **Datastream**：用於在數據庫、存儲系統和應用程序之間同步數據。

**5. 使用案例：Wayfair**

-   **挑戰**：Wayfair 需要快速將運行在 SQL Server 上的本地數據中心遷移到 Google Cloud，避免對其 3000 多名工程師、數千萬客戶和 16000 個供應商合作伙伴造成不便。
-   **解決方案**：使用 Cloud SQL for SQL Server 進行提升和轉移，然後使用雲數據庫現代化工作負載。
-   **結果**：完成遷移後，Wayfair 使用 Google Kubernetes Engine (GKE) 和 Compute Engine VM 託管服務，並使用 Pub/Sub 和 Dataflow 將運營數據發送到 BigQuery 中的分析存儲。

**6. 選擇 Google Cloud 的原因**

-   **靈活性**：可以謹慎選擇運行系統的引擎和產品，允許在虛擬機 (VM) 上運行 SQL Server，也能受益於 Cloud SQL 和 Spanner 等數據庫產品。
