# 4. Modernize Infrastructure and Applications with Google Cloud

## 4.1 Modernizing Infrastructure in the Cloud

### 4.1.1 The benefits of running compute workloads in the cloud

1. **總擁有成本（TCO）：**

    - 雲計算通過消除購買和維護物理基礎設施的需求，幫助企業節省 IT 成本。
    - 提供按需付費模式，企業只需為使用的資源付費，並且對長期承諾提供折扣，進一步降低 TCO。

2. **可擴展性：**

    - 根據需求變化，靈活地增加或減少資源，如服務器、存儲和帶寬，無需大規模前期投資。
    - 面對需求激增，企業可以輕鬆擴展雲資源；需求減少時則可以快速縮減資源以節省成本。

3. **可靠性：**

    - 雲提供商提供高度的可靠性和正常運行時間，確保數據和應用程序在需要時可用。
    - Google Cloud 擁有多個數據中心，確保一個數據中心宕機時其他數據中心能繼續運行。
    - 使用多種技術監控服務並自動檢測和修復問題。

4. **安全性：**

    - 提供高度的數據和應用程序安全性，包括數據加密、身份和訪問管理、網絡安全、虛擬私有雲和實時監控服務。
    - 確保符合政府或行業法規。

5. **靈活性：**

    - 組織可以根據需求選擇最佳雲服務，並在必要時進行調整。
    - 例如，企業可以根據需要輕鬆增加雲存儲空間。

6. **抽象化：**

    - 雲提供商通過管理硬件、軟件和某些安全和網絡方面，減少客戶理解基礎設施實施細節的需求。
    - 例如，Google Workspace 提供生產力應用程序，客戶無需擔心應用程序的運行和維護細節。

7. **創新平台：**
    - 雲計算幫助組織更快地將產品和服務推向市場，消除開發和維護自有基礎設施的需求。
    - 提供訪問最新技術和工具的平台，支持創新。

通過這些優勢，雲端運行計算工作負載能夠顯著提升企業的運營效率和競爭力。

### 4.1.2 Virtual machines

-   背景介紹
    傳統上，各種技術壓力迫使組織將特定的計算硬體資源緊密綁定於特定的應用程式。虛擬化技術解決了這些壓力，允許多個系統在同一硬體上運行，這些系統稱為虛擬機（VM）。虛擬機共享相同的處理、存儲和網絡資源池，使得在同一伺服器上高效且可管理地運行多個應用程式成為可能。

-   Google Cloud 的 Compute Engine
    Compute Engine 是 Google Cloud 的基礎設施即服務（IaaS）產品，允許用戶在 Google 基礎設施上創建和運行虛擬機。這些虛擬機包含完整操作系統的功能和效能，可以像配置物理伺服器一樣指定 CPU 能力、內存、存儲量和操作系統。

-   虛擬機的創建和管理
    虛擬機實例可以通過 Google Cloud 控制台、Google Cloud CLI 命令行界面、基礎設施自動化工具（如 Terraform）或 Compute Engine API 創建和管理。API（應用程式介面）允許不同軟體程序相互通信，詳細內容會在課程後面介紹。

-   計費和折扣

    -   計算引擎按秒計費，最低為一分鐘，並且對運行時間超過一個月 25% 的每個虛擬機，自動應用持續使用折扣。
    -   計算引擎還提供承諾使用折扣，當承諾使用資源一年或三年期時，比按需價格提供更多折扣。
    -   可搶佔和現貨虛擬機可以將成本降低多達 90%，但計算引擎有權終止這些虛擬機，需要確保工作可以在不中斷的情況下停止和重啟。

-   自定義機器類型
    用戶可以選擇其實例的機器屬性，如虛擬 CPU 的數量、操作系統和內存量，通過使用一組預定義的機器類型或創建自定義機器類型來配置虛擬機。

-   小結
    虛擬化技術及 Google Cloud 的 Compute Engine 提供了一種靈活、高效且可管理的方式來運行多個應用程式，同時通過多種計費和折扣方式降低成本，並允許用戶根據需求自定義虛擬機的配置。

### 4.1.3 Containers

#### 基礎設施即服務（IaaS）概念

基礎設施即服務（IaaS）允許用戶通過使用虛擬機器來虛擬化硬件，從而與其他開發者共享計算資源。每個開發者都能部署自己的操作系統，訪問硬件，並在一個自包含的環境中構建應用程序，使用必要的系統資源。

#### 虛擬機器與容器的區別

-   **虛擬機器**：虛擬化整個機器，包括硬件層，啟動速度較慢，使用較多內存。
-   **容器**：僅虛擬化操作系統層之上的軟件層，啟動速度更快，使用內存較少。容器打包了應用程序及其所有依賴項，擁有運行所需的一切。

#### 容器的優勢

1. **效率更高**：啟動速度快，內存使用少。
2. **獨立性**：可以獨立開發、測試和部署，非常適合微服務架構。
3. **靈活性**：容器幾乎可以在任何地方運行，使得開發和部署變得簡單。

#### 微服務架構

-   **組成**：由較小的獨立服務組成，這些服務運行容器化應用程序。
-   **通信**：通過 API 或其他輕量級通信方法（如 REST 或 gRPC）進行通信。
-   **優勢**：如果客戶要求添加新功能或更改應用程序，開發者可以輕鬆更新應用程序的特定部分而不影響其他部分。

#### 總結

容器技術提供了一種高效、靈活的方式來運行軟件服務。與傳統的虛擬機相比，容器啟動速度更快，內存使用更少，並且可以在任何地方運行，這使得它們非常適合現代的微服務架構。

### 4.1.4 Managing containers 容器管理

#### 容器的優勢

容器提高了敏捷性、增強安全性、優化資源並簡化了雲端應用程式管理。許多組織同時使用虛擬機和容器，但隨著 IT 基礎設施變得更加複雜，他們需要一種方法來管理服務和機器。

#### Kubernetes

Kubernetes 最初由 Google 開發，是一個開源平台，用於管理容器化工作負載和服務。它使得在多個主機上協調多個容器、擴展它們以及輕鬆部署更新和回滾變得容易，從而提高應用程式的可靠性，減少管理和運營所需的時間和資源。

#### Google Kubernetes Engine (GKE)

Google Kubernetes Engine (GKE) 是 Google 在雲端托管的、受管理的 Kubernetes 服務。GKE 環境由多台機器組成，特別是計算引擎實例分組形成集群。GKE 集群可以定制，支持不同的機器類型、節點數量和網絡設置，並通過提供 API 和基於 Web 的控制台，使部署應用程式變得容易。

#### GKE 的應用案例

Ubie 是一家日本的醫療保健科技初創公司，使用 GKE 自動駕駛模式（Autopilot）來管理其基礎設施，並提供按 Pod 計費的選項。這幫助他們消除了配置和監控集群的需求，僅需為運行中的 Pod 付費，將基礎設施成本降低了 20%，並消除了需要數小時甚至數天完成的基礎設施維護和升級任務。

#### Cloud Run

Cloud Run 是一個完全管理的無服務器平台，用於部署和運行容器化應用程序，無需擔心底層基礎設施。它適合運行需要根據流量快速擴展和縮減的無狀態應用程序，如 Web 應用程序。

#### 總結

-   **GKE**：適合需要大量控制的 Kubernetes 環境和運行複雜應用程序。
-   **Cloud Run**：適合需要簡單、完全管理的、可以快速擴展和縮減的無服務器平台。

這兩者提供了靈活的選擇，滿足不同的應用需求和管理要求。

### 4.1.5 Serverless computing 無伺服器運算

#### 無伺服器運算的定義

無伺服器運算並不意味著沒有伺服器，而是指在背景中根據需要自動配置計算資源。這種模式下，組織只需支付實際使用的計算資源費用，無需支付閒置資源的成本。

#### 無伺服器運算的優勢

1. **降低運營成本**：基礎設施和維護由雲提供商負責，應用程式所有者無需投入基礎設施和管理資源。
2. **自動擴展**：根據應用程式需求自動擴展計算資源，雲提供商管理擴展過程，應用程式所有者只需支付實際使用的資源費用。
3. **更快的上市時間**：消除了對基礎設施設置和配置的需求，減少了部署應用程式所需的時間，使應用程式所有者可以專注於編寫代碼和快速部署新功能。
4. **減少開發成本**：開發過程簡化，開發人員可以專注於應用程式邏輯而不是底層基礎設施。
5. **提高彈性和可用性**：雲提供商自動管理基礎設施的故障轉移和災難恢復能力。
6. **按使用付費的定價模式**：應用程式所有者只需為使用的計算資源付費，減少未使用資源的成本並幫助優化成本。

#### Google Cloud 的無伺服器運算產品

1. **Cloud Run**：一個完全管理的環境，用於運行容器化應用程式，無需擔心底層基礎設施。
2. **Cloud Functions**：託管簡單單一用途功能的平台，用於響應從雲基礎設施和服務發出的事件，例如新訂單時發送通知。
3. **App Engine**：構建和部署 Web 應用程式的服務。

#### 實例：Mashme.io 的應用

Mashme.io 是一家專注於教育技術的公司，為 73 個國家的超過 300 萬用戶提供視頻協作體驗。他們需要一個能夠支持日常部署並提供安全網關的基礎設施，以連接到各種客戶網絡和設置。Mashme.io 選擇使用 Google Kubernetes Engine（GKE），並利用 GKE 自動駕駛模式（Autopilot）來管理其基礎設施，實現按 Pod 計費的模式。

#### 總結

無伺服器運算提供了多種優勢，包括降低運營和開發成本、自動擴展、更快的上市時間以及提高彈性和可用性。Google Cloud 提供多種無伺服器運算產品，如 Cloud Run、Cloud Functions 和 App Engine，適用於不同的應用場景和需求。通過這些產品，組織可以更高效地管理應用程式，並專注於核心業務邏輯。

## 4.2 Modernizing Applications in the Cloud

### 4.2.1 The benefits of modern cloud application development 現代雲應用程式開發的好處

#### 軟體開發的演變

由於雲技術的進步，軟體應用程式的開發方式已經發生了巨大的變化。現代雲應用程式開發使軟體開發變得靈活、可擴展，並使用最新的雲計算技術來構建和部署應用程式。傳統的單體應用程式要求所有組件作為一個緊密耦合的單元開發和部署，而現代方法則不同。

#### 現代雲應用程式的優勢

1. **架構**：

    - **微服務**：現代雲應用程式通常被構建為一組微服務。微服務是可獨立部署、可擴展和可維護的組件，這使得組織能夠更快地將商業價值帶入市場，因為功能可以在完成時立即發布。

2. **部署**：

    - **雲端部署**：現代應用程式通常部署到雲端，並使用管理或部分管理的服務。管理服務負責雲端基礎設施的日常管理（如修補、升級和監控），讓員工可以專注於開發新應用程式。部分管理服務提供了一種混合方法，企業自己管理其雲端應用程式的某些方面，而雲提供商管理其他方面。

3. **成本**：

    - **按需付費**：現代雲應用程式使用按需付費的定價模式，當配置得當時，可以極具成本效益。組織不必為未充分利用的資源付費，並且開發人員可以使用預構建的 API 和其他工具更快地構建和部署應用程式。

4. **可擴展性**：

    - **靈活擴展**：現代雲端應用程式可以輕鬆地擴大或縮小以滿足用戶需求，設計為高可用性和彈性，具有負載均衡和自動故障轉移功能。

5. **可靠性**：
    - **監控與管理**：雲服務提供商提供強大的監控和管理工具，使開發人員能夠快速識別和回應問題，進一步提高雲應用程式的可靠性。

#### 總結

現代雲應用程式開發方法提供了多方面的優勢，包括靈活的架構、有效的部署、降低的成本、靈活的可擴展性和高可靠性。這些優勢使得組織能夠更快速地將創新產品推向市場，並且能夠應對不斷變化的業務需求。

### 4.2.2 Rehosting legacy applications in the cloud 將舊式應用程式重新託管到雲端的好處和挑戰

#### 現代化與雲端遷移

當企業決定現代化並將其業務遷移到雲端時，可能會運行一些與雲原生應用程式不兼容的專門舊式應用程式。在這些情況下，企業可能會選擇重新託管遷移路徑，通常稱為“提升和轉移”，即將應用程式從本地環境移動到雲環境，而不對應用程式本身進行任何更改。

#### 重新託管的好處

1. **成本節省**：雲計算消除了購買和維護物理基礎設施的需求。
2. **可擴展性**：可以根據需求輕鬆擴展或縮減資源。
3. **可靠性**：雲提供商提供高可靠性和正常運行時間。
4. **安全性**：雲提供商提供高級安全措施和合規支持。

#### 重新託管的潛在缺點

1. **複雜性**：重新託管可能是一個複雜的過程，需要仔細規劃和適當的資源。
2. **風險**：遷移過程中存在風險，需要仔細評估和管理。
3. **供應商鎖定**：遷移到雲端後，可能會被鎖定在特定的雲提供商，未來更換提供商可能會很困難。

#### Google Cloud 的解決方案

1. **Google Cloud VMware Engine**：

    - 幫助將現有的 VMware 工作負載遷移到雲端，無需重新設計應用程式或重新調整操作。
    - 組織可以維持現有的 VMware 環境和運營流程，同時受益於 Google Cloud 的可擴展性、安全性和可靠性。
    - 組織還可以訪問如 BigQuery、AI/ML 和 Google Kubernetes Engine 等 Google Cloud 服務，現代化應用程式環境並使用新的功能和技術。

2. **Bare Metal Solution**：
    - 對於使用 Oracle 舊式應用程式的組織，Google Cloud 提供了這個全管理的雲基礎設施解決方案。
    - 允許組織在雲端的專用裸機服務器上運行其 Oracle 工作負載，滿足高性能需求。

這些解決方案使得組織能夠在現代化其應用程式環境的同時，利用 Google Cloud 的可擴展性、安全性和可靠性，並訪問先進技術和服務。

### 4.2.3 Application programming interfaces (APIs)

#### 簡化軟體服務的實現

實現軟體服務通常複雜且多變，如果每個服務都需要單獨編碼，結果可能會脆弱且容易出錯。使用 API 可以簡化這一過程。

#### API 的基本概念

API 是一組指令集，讓不同軟體程式相互通信。它像是一個中介，提供標準化和可預測的方式來交換數據和互動。就像餐廳的服務員接受訂單、與廚房溝通並將食物帶給顧客一樣，API 接受請求、進行通信並返回回應。

#### API 的應用

API 可以用於社交媒體平台、移動應用和網路服務等多種應用。開發者可以使用 API 訪問其他程式的功能和數據，而無需自己編寫所有代碼，節省時間和精力。

#### Google 提供的 API

Google 提供了許多 API，允許開發者訪問其產品和服務，例如搜索網站、訪問 Google 地圖數據（如地圖、方向和交通信息）、將文本翻譯成另一種語言等。許多 Google Cloud 產品和服務都有文檔化的 API。

#### API 的商業機會

1. **創建新產品和服務**：組織可以創建 API，讓開發者訪問其數據庫中的數據，用於開發新產品和服務。
2. **產生新收入流**：組織可以向開發者收取訪問 API 的費用，生成新的收入流，幫助抵消開發和維護 API 的成本。
3. **建立合作夥伴關係**：通過暴露 API，組織可以與其他公司或開發者建立合作關係，帶來新的商業機會和合作。

#### API 的價值

通過仔細考慮客戶和合作夥伴的需求，組織可以開發出提供價值並幫助業務增長的 API。使用 API 可以創造新的商業機會，改善用戶體驗，並通過新的收入流和合作夥伴關係促進業務增長。

### 4.2.4 Apigee API Management

#### 有效管理 API 的重要性

當一個組織已經實施了 API，有效地維護和管理它們是很重要的。這可以使用如 Apigee API 管理這樣的平台來完成。Apigee 是 Google Cloud 的 API 管理服務，用於以增強的規模、安全性和自動化來運行 API。

#### Apigee 的優勢

1. **增強安全性**：提供身份驗證、授權和數據加密等功能來保護 API。
2. **實時分析**：使用實時分析和歷史報告來跟蹤和分析 API 的使用情況。
3. **開發和部署支持**：通過可視化 API 編輯器和測試沙箱來幫助開發和部署 API。
4. **版本管理和限流**：提供 API 版本管理、API 文檔以及 API 限流（限制用戶在一定時間內可以發出的 API 請求數量）。

#### 實例：AccuWeather

-   **背景**：AccuWeather 通過 API 與全球合作夥伴共享其天氣數據，這些合作夥伴開發了用於互聯汽車、智能家居、可穿戴設備等的應用程序。
-   **目標**：希望吸引個人開發者，根據他們的不同需求定制產品，並將這些不同的產品層次貨幣化。
-   **解決方案**：Apigee 提供了不同層次的 API 產品，每個產品都有自己的速率限制和定價。
    -   **開發者門戶**：可自定義的 Apigee 開發者門戶允許開發者快速註冊，了解並測試 AccuWeather API。
    -   **內置分析**：AccuWeather 可以密切關注註冊情況、流量來源，並觀察流量活動中的意外模式。

#### 結論

通過 Apigee 管理 API，組織可以確保其 API 的安全性、可擴展性和高效運營。同時，Apigee 的分析功能可以幫助組織更好地了解 API 使用情況，並根據需求進行優化和調整。

### 4.2.5 Hybrid and multi-cloud

#### 企業現狀與挑戰

-   **現狀**：大多數企業計算仍在本地進行，儘管雲計算能夠促進組織發展，但完全遷移至雲端的過程可能複雜且充滿挑戰。
-   **挑戰**：合規性和運營考慮可能導致部分工作負載保留在本地。

#### 混合雲與多雲解決方案

-   **混合雲**：結合本地或私有雲基礎設施與公共雲服務，允許數據和應用程式部分遷移至雲端，部分保留在本地。這是許多組織當前的狀況。
-   **多雲**：使用多個公共雲提供商，以實現靈活性和不同網絡之間的安全連接。

#### 雲計算的好處

-   **靈活性**：只將特定工作負載移至雲端，受益於雲服務的靈活性、可擴展性和更低的計算成本。
-   **專門服務**：添加機器學習、內容緩存、數據分析、長期存儲和物聯網等專門服務，提升運營能力。
-   **系統互操作性**：私有雲和公共雲之間的互連允許互操作性。

#### Google Cloud 解決方案

-   **GKE Enterprise**：Google Cloud 的 GKE Enterprise 是一個管理的生產就緒平台，用於在多個雲環境中運行 Kubernetes 應用程式。
    -   **多雲和混合雲支持**：GKE Enterprise 可以在 Google Cloud、AWS、Azure 和其他公共雲上運行 Kubernetes 集群。
    -   **集中管理**：提供單一集中控制台，管理 Kubernetes 集群和應用程式，確保安全性和合規性。
    -   **網絡和負載均衡**：包含多種功能，有助於網絡和負載均衡 Kubernetes 應用程式。
    -   **監控和日誌記錄**：提供豐富的工具，用於監控和維護整個網絡的應用程式一致性，無論是在本地、雲端還是多個雲中。

#### 總結

混合雲和多雲解決方案允許企業在不完全遷移至雲端的情況下實現 IT 基礎設施現代化，受益於雲服務的靈活性、可擴展性和安全性。Google Cloud 的 GKE Enterprise 提供了強大的管理工具，幫助企業在多個雲環境中高效運行和管理其應用程式。

## 4.3 Course Summary

### 4.3.1 Summary
